<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="None">
  
  <link rel="shortcut icon" href="./img/favicon.ico">
  <title>Home - FHIRcast</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="./css/theme.css" type="text/css" />
  <link rel="stylesheet" href="./css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="./css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Home";
    var mkdocs_page_input_path = "index.md";
    var mkdocs_page_url = "/";
  </script>
  
  <script src="./js/jquery-2.1.1.min.js"></script>
  <script src="./js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="./js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> FHIRcast</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1 current">
		
    <a class="current" href=".">Home</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#fhircast-modern-simple-application-context-synchronization">FHIRcast - modern, simple application context synchronization</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#overview">Overview</a></li>
        
            <li><a class="toctree-l3" href="#synchronize">Synchronize</a></li>
        
            <li><a class="toctree-l3" href="#event-catalog">Event Catalog</a></li>
        
            <li><a class="toctree-l3" href="#get-involved">Get involved</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="usersession/">UserSession</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">FHIRcast</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Home</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="fhircast-modern-simple-application-context-synchronization">FHIRcast - <em>modern, simple application context synchronization</em></h1>
<h2 id="overview">Overview</h2>
<p>FHIRcast synchronizes healthcare applications in real time to show the same clinical content to a common user. For example, a radiologist often works in three disparate applications at the same time (a radiology information system, a PACS and a dictation system), she wants each of these three systems to display the same study or patient at the same time. </p>
<p>FHIRcast isn't limited to radiology use-cases. Using <a href="https://www.hl7.org/fhir/subscription.html">FHIR Subscriptions</a>, FHIRcast naturally extends the SMART on FHIR launch protocol to achieve tight integration between disparate, full-featured applications. FHIRcast builds on the <a href="https://en.wikipedia.org/wiki/CCOW">CCOW</a> abstract model to specify an http-based, simple and decentralized context synchronization specification. For simplicity, the below describes an app synchronizing with an EHR, but any user-facing application can synchronize with FHIRcast. While less common,  bidirectional communication between multiple application is also possible.</p>
<h3 id="why">Why?</h3>
<p>The large number of vendor-specific or proprietary context synchronization methods in production use limit the industry's ability to enhance the large number of integrations currently in production. In practice, these integrations are decentralized and simple. </p>
<h2 id="synchronize">Synchronize</h2>
<p>An app creates a subscription to the EHR's UserSession and is then notified when the focus of the session changes, for example, by the clinician opening a patient's chart. The app deletes its subscription when it no longer wants to receive notifications.</p>
<p>[TODO: Simple, attractive image illustrating actors and key interactions]</p>
<h3 id="ehr-launches-smart-on-fhir-app">EHR launches SMART on FHIR App</h3>
<p>The EHR launches the app following the standard (SMART on FHIR EHR launch)[http://www.hl7.org/fhir/smart-app-launch#ehr-launch-sequence]  flow, including identifying the current EHR user using OpenID Connect. As part of the app launch, alongside the acess_token the EHR's authorization server identifies the current user's <a href="./usersession/">UserSession</a>:</p>
<pre><code>{
  &quot;access_token&quot;: &quot;i8hweunweunweofiwweoijewiwe&quot;,
  &quot;token_type&quot;: &quot;bearer&quot;,
  &quot;expires_in&quot;: 3600,
  &quot;patient&quot;:  &quot;123&quot;,
  &quot;encounter&quot;: &quot;456&quot;,
  &quot;usersession&quot; : &quot;789&quot;
}
</code></pre>

<p>Although FHIRcast works best with the SMART on FHIR launch and authorization process, it can also be used with implementation-specific launch and authz protocols.</p>
<h3 id="app-subscribes-to-usersession-changes">App subscribes to UserSession changes</h3>
<p>The app finds or creates an EventDefinition that describes the change it wants to be notified of. </p>
<pre><code>GET &lt;fhir base url&gt;/EventDefinition?name=patient-chart-open
</code></pre>

<pre><code>{
  &quot;resourceType&quot;: &quot;EventDefinition&quot;,
  &quot;id&quot;: &quot;abc&quot;,
  &quot;status&quot;: &quot;active&quot;,
  &quot;name&quot;: &quot;patient-chart-open&quot;,
  &quot;description&quot;: &quot;Patient in focus changes in UserSession&quot;,
  &quot;trigger&quot;: {
    &quot;type&quot;: &quot;named-event&quot;,
    &quot;data&quot;: {
      &quot;type&quot;: &quot;UserSession&quot;
    },
    &quot;condition&quot;: {
      &quot;description&quot;: &quot;Current UserSession.focus contains a Patient not in previous UserSession.focus&quot;,
      &quot;language&quot;: &quot;text/fhirpath&quot;,
      &quot;expression&quot;: &quot;this.focus.ofType(Patient) and this.focus != %previous.focus&quot;
    }
  }
}
</code></pre>

<p>[TODO - ask Bryn for correct syntax for multiple common workflow events]</p>
<h3 id="the-app-creates-a-subscription-on-the-ehrs-fhir-server-for-the-given-eventdefinition">The app creates a Subscription on the EHR's FHIR server for the given EventDefinition:</h3>
<p>In this example, the app asks to be notified of new events via a <em>rest-hook</em> with the modified resource in the http body. FHIR Subscriptions also describes other possible channels. Note that the bearer access_token used to authenticate to the FHIR server was initially granted during the SMART launch.</p>
<pre><code>POST &lt;fhir base url&gt;/Subscription
Authorization: Bearer i8hweunweunweofiwweoijewiwe
</code></pre>

<pre><code>{
  &quot;resourceType&quot;: &quot;Subscription&quot;,
  &quot;criteria&quot;: &quot;UserSession?_id=123&quot;,
  &quot;topic&quot;: &quot;&lt;fhir base url&gt;/EventDefinition/abc&quot;,
  &quot;channel&quot;: {
    &quot;type&quot;: &quot;rest-hook&quot;,
    &quot;endpoint&quot;: &quot;&lt;app notification endpoint&gt;/on-patientchartopen&quot;,
    &quot;payload&quot;: &quot;application/fhir+json&quot;
  }
}
</code></pre>

<h3 id="ehr-responds-with-successful-creation">EHR responds with successful creation</h3>
<pre><code>201 Created
Location: &lt;fhir base url&gt;/Subscription/sub00001
</code></pre>

<h3 id="ehr-notifies-app-of-change">EHR notifies app of change</h3>
<pre><code>PUT &lt;app notification endpoint&gt;/on-patientchartopen/UserSession
</code></pre>

<pre><code>{
  &quot;resourceType&quot;: &quot;UserSession&quot;,
  &quot;id&quot; : &quot;xyz&quot;,
  &quot;user&quot;: &quot;Practitioner/prov123&quot;,
  &quot;status&quot; : {
    &quot;value&quot; : &quot;activating&quot;,
    &quot;source&quot; : &quot;user&quot;
  }
  &quot;workstation&quot; : &quot;Location/readingworkstation456&quot;,
  &quot;focus&quot; : [
    &quot;Patient/789&quot;,
    &quot;Encounter/100009181&quot;
  ],
  &quot;created&quot; : &quot;2017-12-11T09:57:34.2112Z&quot;,
 }
</code></pre>

<h3 id="app-unsubscribes-to-usersession-changes">App unsubscribes to UserSession changes</h3>
<pre><code>DELETE &lt;fhir base url&gt;/Subscription/sub00001
</code></pre>

<h2 id="event-catalog">Event Catalog</h2>
<ol>
<li>open-patient-chart</li>
<li>switch-patient-chart</li>
<li>close-patient-chart</li>
<li>open-imaging-study</li>
<li>switch-imaging-study</li>
<li>close-imaging-study</li>
<li>user-login</li>
<li>user-logout</li>
<li>user-hibernates</li>
</ol>
<p>[TODO - define fhirpath / Event definitions with names for common workflow events]</p>
<h2 id="get-involved">Get involved</h2>
<p>https://chat.fhir.org/#narrow/stream/subscriptions
https://github.com/fhircast</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="usersession/" class="btn btn-neutral float-right" title="UserSession">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
        <span style="margin-left: 15px"><a href="usersession/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="./js/theme.js"></script>

</body>
</html>

<!--
MkDocs version : 0.16.3
Build Date UTC : 2017-10-16 02:33:33
-->
